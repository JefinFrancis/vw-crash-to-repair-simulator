"""Initial schema with all models

Revision ID: 500d63b16700
Revises: 
Create Date: 2026-01-29 19:34:29.771518

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = '500d63b16700'
down_revision = None
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('dealers',
    sa.Column('name', sa.String(length=200), nullable=False),
    sa.Column('cnpj', sa.String(length=18), nullable=True),
    sa.Column('address', sa.Text(), nullable=False),
    sa.Column('city', sa.String(length=100), nullable=False),
    sa.Column('state', sa.String(length=2), nullable=False),
    sa.Column('postal_code', sa.String(length=9), nullable=True),
    sa.Column('phone', sa.String(length=20), nullable=True),
    sa.Column('email', sa.String(length=100), nullable=True),
    sa.Column('website', sa.String(length=200), nullable=True),
    sa.Column('latitude', sa.Numeric(precision=10, scale=8), nullable=True),
    sa.Column('longitude', sa.Numeric(precision=11, scale=8), nullable=True),
    sa.Column('services', sa.ARRAY(sa.String()), nullable=True),
    sa.Column('specialties', sa.ARRAY(sa.String()), nullable=True),
    sa.Column('working_hours', sa.Text(), nullable=True),
    sa.Column('is_authorized', sa.Boolean(), nullable=False),
    sa.Column('is_active', sa.Boolean(), nullable=False),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_dealers_city'), 'dealers', ['city'], unique=False)
    op.create_index(op.f('ix_dealers_cnpj'), 'dealers', ['cnpj'], unique=True)
    op.create_index(op.f('ix_dealers_name'), 'dealers', ['name'], unique=False)
    op.create_index(op.f('ix_dealers_postal_code'), 'dealers', ['postal_code'], unique=False)
    op.create_index(op.f('ix_dealers_state'), 'dealers', ['state'], unique=False)
    op.create_table('parts',
    sa.Column('part_number', sa.String(length=50), nullable=False),
    sa.Column('name', sa.String(length=200), nullable=False),
    sa.Column('category', sa.String(length=50), nullable=True),
    sa.Column('vehicle_models', postgresql.ARRAY(sa.String()), nullable=True),
    sa.Column('price_brl', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('labor_hours', sa.Numeric(precision=4, scale=2), nullable=False),
    sa.Column('availability_status', sa.String(length=20), nullable=False),
    sa.Column('supplier', sa.String(length=100), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('technical_specs', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_parts_availability_status'), 'parts', ['availability_status'], unique=False)
    op.create_index(op.f('ix_parts_category'), 'parts', ['category'], unique=False)
    op.create_index(op.f('ix_parts_name'), 'parts', ['name'], unique=False)
    op.create_index(op.f('ix_parts_part_number'), 'parts', ['part_number'], unique=True)
    op.create_index(op.f('ix_parts_price_brl'), 'parts', ['price_brl'], unique=False)
    op.create_index(op.f('ix_parts_supplier'), 'parts', ['supplier'], unique=False)
    op.create_table('vehicles',
    sa.Column('model', sa.String(length=50), nullable=False),
    sa.Column('year', sa.Integer(), nullable=False),
    sa.Column('vin', sa.String(length=17), nullable=True),
    sa.Column('beamng_model', sa.String(length=100), nullable=True),
    sa.Column('beamng_config', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_vehicles_model'), 'vehicles', ['model'], unique=False)
    op.create_index(op.f('ix_vehicles_vin'), 'vehicles', ['vin'], unique=True)
    op.create_index(op.f('ix_vehicles_year'), 'vehicles', ['year'], unique=False)
    op.create_table('damage_reports',
    sa.Column('vehicle_id', sa.UUID(), nullable=False),
    sa.Column('simulation_id', sa.String(length=100), nullable=True),
    sa.Column('beamng_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('overall_severity', sa.String(length=20), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.ForeignKeyConstraint(['vehicle_id'], ['vehicles.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_damage_reports_overall_severity'), 'damage_reports', ['overall_severity'], unique=False)
    op.create_index(op.f('ix_damage_reports_simulation_id'), 'damage_reports', ['simulation_id'], unique=True)
    op.create_index(op.f('ix_damage_reports_vehicle_id'), 'damage_reports', ['vehicle_id'], unique=False)
    op.create_table('appointments',
    sa.Column('dealer_id', sa.UUID(), nullable=False),
    sa.Column('damage_report_id', sa.UUID(), nullable=True),
    sa.Column('customer_name', sa.String(length=200), nullable=False),
    sa.Column('customer_phone', sa.String(length=20), nullable=True),
    sa.Column('customer_email', sa.String(length=100), nullable=True),
    sa.Column('customer_cpf', sa.String(length=14), nullable=True),
    sa.Column('vehicle_vin', sa.String(length=17), nullable=True),
    sa.Column('vehicle_license_plate', sa.String(length=8), nullable=True),
    sa.Column('scheduled_date', sa.DateTime(timezone=True), nullable=False),
    sa.Column('estimated_duration_hours', sa.String(length=10), nullable=True),
    sa.Column('service_type', sa.String(length=50), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.ForeignKeyConstraint(['damage_report_id'], ['damage_reports.id'], ),
    sa.ForeignKeyConstraint(['dealer_id'], ['dealers.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_appointments_customer_cpf'), 'appointments', ['customer_cpf'], unique=False)
    op.create_index(op.f('ix_appointments_damage_report_id'), 'appointments', ['damage_report_id'], unique=False)
    op.create_index(op.f('ix_appointments_dealer_id'), 'appointments', ['dealer_id'], unique=False)
    op.create_index(op.f('ix_appointments_scheduled_date'), 'appointments', ['scheduled_date'], unique=False)
    op.create_index(op.f('ix_appointments_service_type'), 'appointments', ['service_type'], unique=False)
    op.create_index(op.f('ix_appointments_status'), 'appointments', ['status'], unique=False)
    op.create_index(op.f('ix_appointments_vehicle_license_plate'), 'appointments', ['vehicle_license_plate'], unique=False)
    op.create_index(op.f('ix_appointments_vehicle_vin'), 'appointments', ['vehicle_vin'], unique=False)
    op.create_table('damage_components',
    sa.Column('damage_report_id', sa.UUID(), nullable=False),
    sa.Column('component_name', sa.String(length=100), nullable=False),
    sa.Column('severity', sa.String(length=20), nullable=False),
    sa.Column('damage_type', sa.String(length=50), nullable=True),
    sa.Column('repair_required', sa.Boolean(), nullable=False),
    sa.Column('replacement_required', sa.Boolean(), nullable=False),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.ForeignKeyConstraint(['damage_report_id'], ['damage_reports.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_damage_components_component_name'), 'damage_components', ['component_name'], unique=False)
    op.create_index(op.f('ix_damage_components_damage_report_id'), 'damage_components', ['damage_report_id'], unique=False)
    op.create_index(op.f('ix_damage_components_severity'), 'damage_components', ['severity'], unique=False)
    op.drop_table('health_check')
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('health_check',
    sa.Column('id', sa.UUID(), server_default=sa.text('uuid_generate_v4()'), autoincrement=False, nullable=False),
    sa.Column('service_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=20), server_default=sa.text("'healthy'::character varying"), autoincrement=False, nullable=False),
    sa.Column('last_check', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('details', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('health_check_pkey'))
    )
    op.drop_index(op.f('ix_damage_components_severity'), table_name='damage_components')
    op.drop_index(op.f('ix_damage_components_damage_report_id'), table_name='damage_components')
    op.drop_index(op.f('ix_damage_components_component_name'), table_name='damage_components')
    op.drop_table('damage_components')
    op.drop_index(op.f('ix_appointments_vehicle_vin'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_vehicle_license_plate'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_status'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_service_type'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_scheduled_date'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_dealer_id'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_damage_report_id'), table_name='appointments')
    op.drop_index(op.f('ix_appointments_customer_cpf'), table_name='appointments')
    op.drop_table('appointments')
    op.drop_index(op.f('ix_damage_reports_vehicle_id'), table_name='damage_reports')
    op.drop_index(op.f('ix_damage_reports_simulation_id'), table_name='damage_reports')
    op.drop_index(op.f('ix_damage_reports_overall_severity'), table_name='damage_reports')
    op.drop_table('damage_reports')
    op.drop_index(op.f('ix_vehicles_year'), table_name='vehicles')
    op.drop_index(op.f('ix_vehicles_vin'), table_name='vehicles')
    op.drop_index(op.f('ix_vehicles_model'), table_name='vehicles')
    op.drop_table('vehicles')
    op.drop_index(op.f('ix_parts_supplier'), table_name='parts')
    op.drop_index(op.f('ix_parts_price_brl'), table_name='parts')
    op.drop_index(op.f('ix_parts_part_number'), table_name='parts')
    op.drop_index(op.f('ix_parts_name'), table_name='parts')
    op.drop_index(op.f('ix_parts_category'), table_name='parts')
    op.drop_index(op.f('ix_parts_availability_status'), table_name='parts')
    op.drop_table('parts')
    op.drop_index(op.f('ix_dealers_state'), table_name='dealers')
    op.drop_index(op.f('ix_dealers_postal_code'), table_name='dealers')
    op.drop_index(op.f('ix_dealers_name'), table_name='dealers')
    op.drop_index(op.f('ix_dealers_cnpj'), table_name='dealers')
    op.drop_index(op.f('ix_dealers_city'), table_name='dealers')
    op.drop_table('dealers')
    # ### end Alembic commands ###